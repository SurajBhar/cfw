# Smoke BOHB config for fast validation
# Use with: python scripts/bayesian_optimize.py +optimization=bayesian_smoke

non_interactive: true

search_space:
  learning_rate:
    lower: 1e-4
    upper: 1e-3
    log: true

  weight_decay:
    lower: 1e-6
    upper: 1e-4
    log: true

  optimizer:
    choices: ["ADAM", "SGD"]

bohb:
  max_t: 3
  reduction_factor: 2
  stop_last_trials: true

tuner:
  num_samples: 4
  max_concurrent: 2
  metric: "val_balanced_accuracy"
  mode: "max"

ray:
  mode: local
  address: auto
  namespace: cfw-ray-smoke
  num_cpus: null
  num_gpus: null
  resources_per_trial:
    cpu: 2
    gpu: 1

storage:
  path: "./outputs_smoke/ray_results"
  name: "cfw_bohb_smoke"

checkpoints_to_keep: 2
evaluate_test_on_best: false
verbose: 1
